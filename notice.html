<!DOCTYPE html>
<html>
<head>
    <title>Notices</title>
    <link rel="stylesheet" href="css/notice-style.css">
</head>
<body>

<h2>College Notices</h2>

<div id="noticeContainer"></div>

<script src="script.js"></script>
<script>
    const userid = localStorage.getItem("userid");
    if (!userid) {
        alert("Please login first");
        window.location.href = "index.html";
    }

    fetch("http://ec2-16-171-137-208.eu-north-1.compute.amazonaws.com/api/student/notices")
        .then(res => {
            console.log("Notices API status:", res.status);
            return res.json();
        })
        .then(data => {
            console.log("Notices data:", data);

            const container = document.getElementById("noticeContainer");
            container.innerHTML = "";

            if (!Array.isArray(data) || data.length === 0) {
                container.innerHTML = "<p>No notices available</p>";
                return;
            }

            data.forEach(n => {
                container.innerHTML += `
                    <div class="notice">
                        <h3>${n.title}</h3>
                        <p>${n.description}</p>
                        <small>${n.date ?? ""}</small>
                    </div>
                `;
            });
        })
        .catch(err => {
            console.error("Notices fetch failed:", err);
            alert("Failed to load notices");
        });
</script>

</body>
</html>
