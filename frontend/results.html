<!DOCTYPE html>
<html>
<head>
    <title>My Results</title>
    <link rel="stylesheet" href="css/results-style.css">
</head>
<body>

<div class="page">
    <h2>My Results</h2>

    <table id="resultsTable">
        <tr>
            <th>Subject</th>
            <th>Marks</th>
            <th>Grade</th>
        </tr>
        <tbody id="resultsBody">
        </tbody>
    </table>
</div>

<script src="script.js"></script>
<script>
    console.log("Results JS loaded");

const userid = localStorage.getItem("userid");
console.log("UserID from storage:", userid);

if (!userid) {
    alert("Please login again");
    window.location.href = "index.html";
    throw new Error("No userid");
}

fetch("http://16.171.137.208:8080/api/student/results/" + userid)
    .then(res => {
        console.log("Results API status:", res.status);
        return res.json();
    })
    .then(data => {
        console.log("Results data:", data);

        const tbody = document.getElementById("resultsBody");
        tbody.innerHTML = "";

        if (!Array.isArray(data) || data.length === 0) {
            tbody.innerHTML = "<tr><td colspan='2'>No results data</td></tr>";
            return;
        }

        data.forEach(r => {
            tbody.innerHTML += `
                <tr>
                    <td>${r.subject}</td>
                    <td>${r.marks}</td>
                </tr>
            `;
        });
    })
    .catch(err => {
        console.error("Results fetch FAILED:", err);
        alert("Failed to load results");
    });

</script>

</body>
</html>
