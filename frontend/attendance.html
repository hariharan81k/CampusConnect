<!DOCTYPE html>
<html>
<head>
    <title>My Attendance</title>
    <link rel="stylesheet" href="css/attendance-style.css">
</head>
<body>

<div class="page">
    <h2>My Attendance</h2>

    <table id="attendanceTable">
        <tr>
            <th>Subject</th>
            <th>Percentage</th>
        </tr>
    </table>
</div>

<script src="script.js"></script>
<script>
   // ðŸ” Check login
const userid = localStorage.getItem("userid");

if (!userid || userid === "null") {
    alert("Session expired. Please login again.");
    window.location.href = "index.html";
    throw new Error("No userid in localStorage");
}

// ðŸ“¡ Fetch attendance from Java backend
fetch(`http://localhost:8080/api/student/attendance/${userid}`)
    .then(response => response.json())
    .then(data => {
        const tbody = document.getElementById("attendanceBody");
        tbody.innerHTML = "";

        if (data.length === 0) {
            tbody.innerHTML = "<tr><td colspan='2'>No attendance data</td></tr>";
            return;
        }

        data.forEach(item => {
            const row = `
                <tr>
                    <td>${item.subject}</td>
                    <td>${item.percentage}</td>
                </tr>
            `;
            tbody.innerHTML += row;
        });
    })
    .catch(error => {
        console.error("Error:", error);
        alert("Failed to load attendance");
    });

</script>

</body>
</html>
